import{world as B}from"@minecraft/server";import{Direction as f}from"@minecraft/server";import{system as z,world as w}from"@minecraft/server";import{system as H}from"@minecraft/server";import{BlockPermutation as J,world as Q}from"@minecraft/server";import{world as _}from"@minecraft/server";import{Player as et}from"@minecraft/server";import{system as it}from"@minecraft/server";import{system as k}from"@minecraft/server";import{system as F,world as C}from"@minecraft/server";import{Player as W,system as P,world as R}from"@minecraft/server";import{InputPermissionCategory as ht}from"@minecraft/server";import{system as mt}from"@minecraft/server";import{Direction as l}from"@minecraft/server";import{StructureSaveMode as yt,world as Et}from"@minecraft/server";import{EntityEquippableComponent as At,EquipmentSlot as wt,ItemDurabilityComponent as Ct,ItemEnchantableComponent as It}from"@minecraft/server";var a=class n{constructor(t,e){this.code=t,this.color=e,e&&(this.r=e>>16&255,this.g=e>>8&255,this.b=e&255)}static BLACK=new n("0",0);static DARK_BLUE=new n("1",170);static DARK_GREEN=new n("2",43520);static DARK_AQUA=new n("3",43690);static DARK_RED=new n("4",11141120);static DARK_PURPLE=new n("5",11141290);static GOLD=new n("6",16755200);static GRAY=new n("7",11184810);static DARK_GRAY=new n("8",5592405);static BLUE=new n("9",5592575);static GREEN=new n("a",5635925);static AQUA=new n("b",5636095);static RED=new n("c",16733525);static LIGHT_PURPLE=new n("d",16733695);static YELLOW=new n("e",16777045);static WHITE=new n("f",16777215);static MINECOIN_GOLD=new n("g",14603781);static MATERIAL_QUARTZ=new n("h",14931153);static MATERIAL_IRON=new n("i",13552330);static MATERIAL_NETHERITE=new n("j",4471355);static MATERIAL_REDSTONE=new n("m",9901575);static MATERIAL_COPPER=new n("n",11823181);static MATERIAL_GOLD=new n("p",14594349);static MATERIAL_EMERALD=new n("q",1155126);static MATERIAL_DIAMOND=new n("s",2931368);static MATERIAL_LAPIS=new n("t",2181499);static MATERIAL_AMETHYST=new n("u",10116294);static OBFUSCATED=new n("k");static BOLD=new n("l");static ITALIC=new n("o");static RESET=new n("r");static VALUES=[n.BLACK,n.DARK_BLUE,n.DARK_GREEN,n.DARK_AQUA,n.DARK_RED,n.DARK_PURPLE,n.GOLD,n.GRAY,n.DARK_GRAY,n.BLUE,n.GREEN,n.AQUA,n.RED,n.LIGHT_PURPLE,n.YELLOW,n.WHITE,n.MINECOIN_GOLD,n.MATERIAL_QUARTZ,n.MATERIAL_IRON,n.MATERIAL_NETHERITE,n.MATERIAL_REDSTONE,n.MATERIAL_COPPER,n.MATERIAL_GOLD,n.MATERIAL_EMERALD,n.MATERIAL_DIAMOND,n.MATERIAL_LAPIS,n.MATERIAL_AMETHYST,n.OBFUSCATED,n.BOLD,n.ITALIC,n.RESET];static ALL_COLORS=[n.BLACK,n.DARK_BLUE,n.DARK_GREEN,n.DARK_AQUA,n.DARK_RED,n.DARK_PURPLE,n.GOLD,n.GRAY,n.DARK_GRAY,n.BLUE,n.GREEN,n.AQUA,n.RED,n.LIGHT_PURPLE,n.YELLOW,n.WHITE,n.MINECOIN_GOLD,n.MATERIAL_QUARTZ,n.MATERIAL_IRON,n.MATERIAL_NETHERITE,n.MATERIAL_REDSTONE,n.MATERIAL_COPPER,n.MATERIAL_GOLD,n.MATERIAL_EMERALD,n.MATERIAL_DIAMOND,n.MATERIAL_LAPIS,n.MATERIAL_AMETHYST];r;g;b;static PREFIX="\xA7";toString(){return n.PREFIX+this.code}toRGB(){return this.color}toHex(){return this.color?.toString(16)}getRed(){return this.r}getGreen(){return this.g}getBlue(){return this.b}getCode(){return this.code}static stripColor(t){return t.replace(/ยง[0-9a-u]/g,"")}static findClosestColor(t,e,i){let r=Number.MAX_VALUE,o=n.WHITE;for(let c of n.ALL_COLORS)if(c.r&&c.g&&c.b){let h=Math.sqrt(Math.pow(c.r-t,2)+Math.pow(c.g-e,2)+Math.pow(c.b-i,2));h<r&&(r=h,o=c)}return o}},j=class D{OpenObject="{";CloseObject="}";OpenArray="[";CloseArray="]";Comma=",";KeyValueSeparator=":";StringDelimiter='"';KeyDelimiter="";Indent="  ";NewLine=`
`;Space=" ";InlineThreshold=60;MaxDepth=1;IncludeClassNames=!0;FunctionValue="\u0192";NullValue="null";UndefinedValue="undefined";TrueValue="true";FalseValue="false";CycleValue="[...cycle...]";TruncatedObjectValue="{...}";OpenCloseObjectColor=a.YELLOW;OpenCloseArrayColor=a.AQUA;NumberColor=a.DARK_AQUA;StringColor=a.DARK_GREEN;BooleanColor=a.GOLD;NullColor=a.GOLD;KeyColor=a.GRAY;EscapeColor=a.GOLD;FunctionColor=a.GRAY;ClassColor=a.GRAY;ClassStyle=a.BOLD;CycleColor=a.DARK_RED;static DEFAULT=new D;static createPlain(){let t=new D;return t.OpenCloseObjectColor="",t.OpenCloseArrayColor="",t.NumberColor="",t.StringColor="",t.BooleanColor="",t.NullColor="",t.KeyColor="",t.EscapeColor="",t.FunctionColor="",t.ClassColor="",t.ClassStyle="",t.CycleColor="",t}static PLAIN=this.createPlain();stringify(t){return this.stringifyValue(t,{indentLevel:0,visited:new WeakSet})}stringifyString(t){return this.StringColor+this.StringDelimiter+this.escapeString(t)+this.StringDelimiter+a.RESET}stringifyNumber(t){return this.NumberColor+t.toString()+a.RESET}stringifyBoolean(t){return this.BooleanColor+(t?this.TrueValue:this.FalseValue)+a.RESET}stringifyFunction(t){return this.FunctionColor+this.FunctionValue+a.RESET}stringifyNull(){return this.NullColor+this.NullValue+a.RESET}stringifyUndefined(){return this.NullColor+this.UndefinedValue+a.RESET}stringifyCycle(){return this.CycleColor+this.CycleValue+a.RESET}stringifyArray(t,e){let i=this.Indent.repeat(e.indentLevel);if(t.length===0)return this.OpenCloseArrayColor+this.OpenArray+this.CloseArray+a.RESET;let r=this.OpenCloseArrayColor+this.OpenArray+a.RESET+this.NewLine,o=this.OpenCloseArrayColor+this.OpenArray+a.RESET;return t.forEach((c,h)=>{r+=i+this.Indent+this.stringifyValue(c,this.indent(e)),r+=h<t.length-1?this.Comma+this.NewLine:this.NewLine,o+=this.stringifyValue(c,this.indent(e)),o+=h<t.length-1?this.Comma+this.Space:""}),r+=i+this.OpenCloseArrayColor+this.CloseArray+a.RESET,o+=this.OpenCloseArrayColor+this.CloseArray+a.RESET,o.length<this.InlineThreshold?o:r}stringifyTruncatedObject(t,e,i){return(this.IncludeClassNames?this.ClassColor+""+this.ClassStyle+e+a.RESET+this.Space:"")+this.TruncatedObjectValue}stringifyObject(t,e,i,r){let o=this.Indent.repeat(r.indentLevel),c=this.IncludeClassNames&&e!=="Object"?this.ClassColor+""+this.ClassStyle+e+a.RESET+this.Space:"";if(i.length===0)return c+this.OpenCloseObjectColor+this.OpenObject+this.CloseObject+a.RESET;let h=c+this.OpenCloseObjectColor+this.OpenObject+a.RESET+this.NewLine,u=c+this.OpenCloseObjectColor+this.OpenObject+a.RESET;return i.forEach(([b,y],v)=>{let O=this.stringifyValue(y,this.indent(r));h+=o+this.Indent+this.KeyColor+this.KeyDelimiter+b+this.KeyDelimiter+a.RESET+this.KeyValueSeparator+this.Space+O,h+=v<i.length-1?this.Comma+this.NewLine:this.NewLine,u+=this.KeyColor+b+a.RESET+this.KeyValueSeparator+this.Space+O,u+=v<i.length-1?this.Comma+this.Space:""}),h+=o+this.OpenCloseObjectColor+this.CloseObject+a.RESET,u+=this.OpenCloseObjectColor+this.CloseObject+a.RESET,u.length<this.InlineThreshold?u:h}shouldTruncateObject(t,e,i){return!(e==="Object"||i.indentLevel<=this.MaxDepth||this.MaxDepth<=0)}stringifyValue(t,e){if(t===null)return this.stringifyNull();if(t===void 0)return this.stringifyUndefined();if(typeof t=="number")return this.stringifyNumber(t);if(typeof t=="string")return this.stringifyString(t);if(typeof t=="boolean")return this.stringifyBoolean(t);if(typeof t=="function")return this.stringifyFunction(t);if(this.isCycle(t,e))return this.stringifyCycle();if(this.markCycle(t,e),Array.isArray(t)){let i=this.stringifyArray(t,e.indentLevel?this.indent(e):e);return this.clearCycle(t,e),i}if(typeof t=="object"){let i=t.constructor.name;if(this.shouldTruncateObject(t,i,e)){let r=this.stringifyTruncatedObject(t,i,e);return this.clearCycle(t,e),r}else{let r=new Set,o=Object.getPrototypeOf(t),c=Object.keys(o);for(;c.length>0;)c.forEach(y=>r.add(y)),o=Object.getPrototypeOf(o),c=Object.keys(o);Object.keys(t).forEach(y=>r.add(y)),r.delete("__cycleDetection__");let u=[...r].sort().map(y=>{try{return[y,t[y]??void 0]}catch{return[y,void 0]}}).filter(([,y])=>typeof y!="function"&&y!==void 0),b=this.stringifyObject(t,i,u,e);return this.clearCycle(t,e),b}}return this.clearCycle(t,e),a.RESET+t.toString()}escapeString(t){return t.replace(/\\/g,this.EscapeColor+"\\\\"+this.StringColor).replace(/"/g,this.EscapeColor+'\\"'+this.StringColor).replace(/\n/g,this.EscapeColor+"\\n"+this.StringColor).replace(/\r/g,this.EscapeColor+"\\r"+this.StringColor).replace(/\t/g,this.EscapeColor+"\\t"+this.StringColor)}markCycle(t,e){e.visited.add(t)}isCycle(t,e){return e.visited.has(t)}clearCycle(t,e){e.visited.delete(t)}indent(t){return{...t,indentLevel:t.indentLevel+1}}},T=void 0;try{T=globalSourceMapping}catch{}var p=class g{constructor(t,e,i=a.RESET){this.level=t,this.name=e,this.color=i}static All=new g(-2,"all");static Trace=new g(-2,"trace",a.DARK_AQUA);static Debug=new g(-1,"debug",a.AQUA);static Info=new g(0,"info",a.GREEN);static Warn=new g(1,"warn",a.GOLD);static Error=new g(2,"error",a.RED);static Fatal=new g(3,"fatal",a.DARK_RED);static Off=new g(100,"off");static values=[g.All,g.Trace,g.Debug,g.Info,g.Warn,g.Error,g.Fatal,g.Off];toString(){return this.color+this.name.toUpperCase()+a.RESET}static parse(t){t=t.toLowerCase();for(let i of g.values)if(i.name===t)return i;let e=parseInt(t);if(!isNaN(e)){for(let i of g.values)if(i.level===e)return i}}};function S(d,t){return d==="*"?!0:d.includes("*")?d.startsWith("*")?t.endsWith(d.substring(1)):d.endsWith("*")?t.startsWith(d.substring(0,d.length-1)):new RegExp(d.replace(/\*/g,".*")).test(t):d===t}var m={level:p.Info,filter:["*"],outputTags:!1,formatFunction:(d,t,e,i=void 0)=>{let r=i!==void 0?`\xA77${i.map(o=>`[${o}]`).join("")}\xA7r`:"";return`[${d}][${a.MATERIAL_EMERALD}${t.name}${a.RESET}]${r} ${e}`},messagesJoinFunction:d=>d.join(" "),jsonFormatter:j.DEFAULT,outputConfig:{[p.Trace.level]:[0,1],[p.Debug.level]:[0,1],[p.Info.level]:[0,1],[p.Warn.level]:[0,1,2],[p.Error.level]:[0,1,3],[p.Fatal.level]:[0,1,3]}},A=class I{constructor(t,e=[]){this.name=t,this.tags=e}static initialized=!1;static init(){I.initialized||(I.initialized=!0,z.afterEvents.scriptEventReceive.subscribe(t=>{if(t.id==="logging:level"||t.id==="log:level")if(!t.message)m.level=p.Info,w.sendMessage(`${a.AQUA}Logging level set to ${a.BOLD}${m.level}`);else{let e=p.parse(t.message);e?(m.level=e,w.sendMessage(`${a.AQUA}Logging level set to ${a.BOLD}${m.level}`)):w.sendMessage(`${a.DARK_RED}Invalid logging level: ${t.message}`)}else(t.id==="logging:filter"||t.id==="log:filter")&&(t.message?m.filter=t.message.split(","):m.filter=["*"],w.sendMessage(`${a.AQUA}Logging filter set to ${a.BOLD}${m.filter.join(", ")}`))}))}static setLevel(t){m.level=t}static setFilter(t){m.filter=t}static setFormatFunction(t){m.formatFunction=t}static setMessagesJoinFunction(t){m.messagesJoinFunction=t}static setTagsOutputVisibility(t){m.outputTags=t}static setJsonFormatter(t){m.jsonFormatter=t}static getOutputConfig(){return m.outputConfig}static getLogger(t,...e){return I.initialized||I.init(),new I(t,e)}log(t,...e){if(!(t.level<m.level.level)){if(m.filter.length===0||this.tags.length===0){this.logRaw(t,...e);return}for(let i of m.filter){if(i.startsWith("!")&&(S(i.substring(1),this.name)||this.tags.some(r=>S(i.substring(1),r))))return;if(S(i,this.name)||this.tags.some(r=>S(i,r))){this.logRaw(t,...e);return}}}}stringifyError(t){let e=t.stack??"";if(T){let i=/\(([^)]+\.js):(\d+)(?::(\d+))?\)/;e=e.split(`
`).map(r=>{let o=i.exec(r);if(o){let c=o[1],h=parseInt(o[2],10)-T.metadata.offset;if(c.includes(T.metadata.filePath)){let u=globalSourceMapping[h];if(u){let b=`(${u.source}:${u.originalLine})`;return r.replace(i,b)}}}return r}).join(`
`)}return`${a.DARK_RED}${a.BOLD}${t.message}
${a.RESET}${a.GRAY}${a.ITALIC}${e}${a.RESET}`}logRaw(t,...e){{let i=e.map(c=>c===void 0?a.GOLD+"undefined"+a.RESET:c===null?a.GOLD+"null"+a.RESET:c&&c instanceof Error?this.stringifyError(c):typeof c=="object"||Array.isArray(c)?m.jsonFormatter.stringify(c)+a.RESET:c.toString()+a.RESET),r=m.formatFunction(t,this,m.messagesJoinFunction(i),m.outputTags?this.tags:void 0),o=m.outputConfig[t.level]||[0,1];if(o.includes(0))try{w.sendMessage(r)}catch{z.run(()=>{w.sendMessage(r)})}o.includes(1)&&(console.originalLog?console.originalLog(a.stripColor(r)):console.log(a.stripColor(r))),o.includes(2)&&console.warn(r),o.includes(3)&&console.error(r)}}trace(...t){this.log(p.Trace,...t)}debug(...t){this.log(p.Debug,...t)}info(...t){this.log(p.Info,...t)}warn(...t){this.log(p.Warn,...t)}error(...t){this.log(p.Error,...t)}fatal(...t){this.log(p.Fatal,...t)}},G=class s{static log=A.getLogger("vec3","vec3","bedrock-boost");static Zero=new s(0,0,0);static Down=new s(f.Down);static Up=new s(f.Up);static North=new s(f.North);static South=new s(f.South);static East=new s(f.East);static West=new s(f.West);x;y;z;constructor(t,e,i){if(t===f.Down)this.x=0,this.y=-1,this.z=0;else if(t===f.Up)this.x=0,this.y=1,this.z=0;else if(t===f.North)this.x=0,this.y=0,this.z=-1;else if(t===f.South)this.x=0,this.y=0,this.z=1;else if(t===f.East)this.x=1,this.y=0,this.z=0;else if(t===f.West)this.x=-1,this.y=0,this.z=0;else if(typeof t=="number")this.x=t,this.y=e,this.z=i;else if(Array.isArray(t))this.x=t[0],this.y=t[1],this.z=t[2];else if(t instanceof s)this.x=t.x,this.y=t.y,this.z=t.z;else{if(!t||!t.x&&t.x!==0||!t.y&&t.y!==0||!t.z&&t.z!==0)throw s.log.error(new Error("Invalid vector"),t),new Error("Invalid vector");this.x=t.x,this.y=t.y,this.z=t.z}}static from(t,e,i){if(t instanceof s)return t;if(typeof t=="number"&&e!==void 0&&i!==void 0)return new s(t,e,i);if(Array.isArray(t))return new s(t);if(t===f.Down)return s.Down;if(t===f.Up)return s.Up;if(t===f.North)return s.North;if(t===f.South)return s.South;if(t===f.East)return s.East;if(t===f.West)return s.West;if(!t||!t.x&&t.x!==0||!t.y&&t.y!==0||!t.z&&t.z!==0)throw s.log.error(new Error("Invalid arguments"),t,e,i),new Error("Invalid arguments");return new s(t.x,t.y,t.z)}static _from(t,e,i){if(t instanceof s)return t;if(typeof t=="number"&&e!==void 0&&i!==void 0)return new s(t,e,i);if(Array.isArray(t))return new s(t);if(t===f.Down)return s.Down;if(t===f.Up)return s.Up;if(t===f.North)return s.North;if(t===f.South)return s.South;if(t===f.East)return s.East;if(t===f.West)return s.West;if(!t||!t.x&&t.x!==0||!t.y&&t.y!==0||!t.z&&t.z!==0)throw s.log.error(new Error("Invalid arguments"),t,e,i),new Error("Invalid arguments");return new s(t.x,t.y,t.z)}copy(){return new s(this.x,this.y,this.z)}static fromYawPitch(t,e){let i;typeof t=="number"?(i=t,e=e):(i=t.y,e=t.x);let r=i*(Math.PI/180),o=e*(Math.PI/180),c=Math.cos(o)*Math.sin(r),h=Math.sin(o),u=Math.cos(o)*Math.cos(r);return new s(c,h,u)}static fromRotation(t,e){let i;typeof t=="number"?(i=t,e=e):(i=t.y,e=t.x);let r=i*(Math.PI/180),o=e*(Math.PI/180),c=-Math.cos(o)*Math.sin(r),h=-Math.sin(o),u=Math.cos(o)*Math.cos(r);return new s(c,h,u)}toYawPitch(){if(this.isZero())throw s.log.error(new Error("Cannot convert zero-length vector to direction")),new Error("Cannot convert zero-length vector to direction");let t=this.normalize(),e=Math.atan2(t.x,t.z)*(180/Math.PI);return{x:Math.asin(t.y)*(180/Math.PI),y:e}}toRotation(){if(this.isZero())throw s.log.error(new Error("Cannot convert zero-length vector to direction")),new Error("Cannot convert zero-length vector to direction");let t=this.normalize(),e=-Math.atan2(t.x,t.z)*(180/Math.PI);return{x:Math.asin(-t.y)*(180/Math.PI),y:e}}add(t,e,i){let r=s._from(t,e,i);return s.from(r.x+this.x,r.y+this.y,r.z+this.z)}subtract(t,e,i){let r=s._from(t,e,i);return s.from(this.x-r.x,this.y-r.y,this.z-r.z)}multiply(t,e,i){if(typeof t=="number"&&e===void 0&&i===void 0)return s.from(this.x*t,this.y*t,this.z*t);let r=s._from(t,e,i);return s.from(r.x*this.x,r.y*this.y,r.z*this.z)}scale(t){return s.from(this.x*t,this.y*t,this.z*t)}divide(t,e,i){if(typeof t=="number"&&e===void 0&&i===void 0){if(t===0)throw new Error("Cannot divide by zero");return s.from(this.x/t,this.y/t,this.z/t)}let r=s._from(t,e,i);if(r.x===0||r.y===0||r.z===0)throw new Error("Cannot divide by zero");return s.from(this.x/r.x,this.y/r.y,this.z/r.z)}normalize(){if(this.isZero())throw s.log.error(new Error("Cannot normalize zero-length vector")),new Error("Cannot normalize zero-length vector");let t=this.length();return s.from(this.x/t,this.y/t,this.z/t)}length(){return Math.hypot(this.x,this.y,this.z)}lengthSquared(){return this.x*this.x+this.y*this.y+this.z*this.z}cross(t,e,i){let r=s._from(t,e,i);return s.from(this.y*r.z-this.z*r.y,this.z*r.x-this.x*r.z,this.x*r.y-this.y*r.x)}distance(t,e,i){let r=s._from(t,e,i);return this.subtract(r).length()}distanceSquared(t,e,i){let r=s._from(t,e,i);return this.subtract(r).lengthSquared()}lerp(t,e){return!t||!e?s.from(this):e===1?s.from(t):e===0?s.from(this):s.from(this.x+(t.x-this.x)*e,this.y+(t.y-this.y)*e,this.z+(t.z-this.z)*e)}slerp(t,e){if(!t||!e)return s.from(this);if(e===1)return s.from(t);if(e===0)return s.from(this);let i=this.dot(t),r=Math.acos(i)*e,o=s.from(t).subtract(this.multiply(i)).normalize();return this.multiply(Math.cos(r)).add(o.multiply(Math.sin(r)))}dot(t,e,i){let r=s._from(t,e,i);return this.x*r.x+this.y*r.y+this.z*r.z}angleBetween(t,e,i){let r=s._from(t,e,i),o=this.dot(r),c=this.lengthSquared();if(c===0)return 0;let h=r.lengthSquared();if(h===0)return 0;let u=Math.sqrt(c*h),b=Math.min(1,Math.max(-1,o/u));return Math.acos(b)}projectOnto(t,e,i){let r=s._from(t,e,i);if(r.isZero())return s.Zero;let o=r.dot(r);if(o===0)return s.Zero;let c=this.dot(r)/o;return s.from(r.x*c,r.y*c,r.z*c)}reflect(t,e,i){let r=s._from(t,e,i),o=this.projectOnto(r);return this.subtract(o.multiply(2))}rotate(t,e){let i=e*Math.PI/180/2,r=Math.cos(i),o=t.x*Math.sin(i),c=t.y*Math.sin(i),h=t.z*Math.sin(i),u=this,b=r*r*u.x+2*c*r*u.z-2*h*r*u.y+o*o*u.x+2*c*o*u.y+2*h*o*u.z-h*h*u.x-c*c*u.x,y=2*o*c*u.x+c*c*u.y+2*h*c*u.z+2*r*h*u.x-h*h*u.y+r*r*u.y-2*o*r*u.z-o*o*u.y,v=2*o*h*u.x+2*c*h*u.y+h*h*u.z-2*r*c*u.x-c*c*u.z+2*r*o*u.y-o*o*u.z+r*r*u.z;return new s(b,y,v)}update(t,e,i){return t||(t=r=>r),e||(e=r=>r),i||(i=r=>r),new s(t(this.x),e(this.y),i(this.z))}setX(t){return typeof t=="number"?new s(t,this.y,this.z):new s(t(this.x),this.y,this.z)}setY(t){return typeof t=="number"?new s(this.x,t,this.z):new s(this.x,t(this.y),this.z)}setZ(t){return typeof t=="number"?new s(this.x,this.y,t):new s(this.x,this.y,t(this.z))}distanceToLineSegment(t,e){let i=s.from(e).subtract(t);if(i.lengthSquared()===0)return this.subtract(t).length();let r=Math.max(0,Math.min(1,this.subtract(t).dot(i)/i.dot(i))),o=s.from(t).add(i.multiply(r));return this.subtract(o).length()}floor(){return this.update(Math.floor,Math.floor,Math.floor)}floorX(){return this.setX(Math.floor)}floorY(){return this.setY(Math.floor)}floorZ(){return this.setZ(Math.floor)}ceil(){return new s(Math.ceil(this.x),Math.ceil(this.y),Math.ceil(this.z))}ceilX(){return this.setX(Math.ceil)}ceilY(){return this.setY(Math.ceil)}ceilZ(){return this.setZ(Math.ceil)}round(){return this.update(Math.round,Math.round,Math.round)}roundX(){return this.setX(Math.round)}roundY(){return this.setY(Math.round)}roundZ(){return this.setZ(Math.round)}up(){return this.add(s.Up)}down(){return this.add(s.Down)}north(){return this.add(s.North)}south(){return this.add(s.South)}east(){return this.add(s.East)}west(){return this.add(s.West)}isZero(){return this.x===0&&this.y===0&&this.z===0}toArray(){return[this.x,this.y,this.z]}toDirection(){if(this.isZero())throw s.log.error(new Error("Cannot convert zero-length vector to direction")),new Error("Cannot convert zero-length vector to direction");let t=this.normalize(),e=Math.max(Math.abs(t.x),Math.abs(t.y),Math.abs(t.z));if(e===t.x)return f.East;if(e===-t.x)return f.West;if(e===t.y)return f.Up;if(e===-t.y)return f.Down;if(e===t.z)return f.South;if(e===-t.z)return f.North;throw s.log.error(new Error("Cannot convert vector to direction"),this),new Error("Cannot convert vector to direction")}toBlockLocation(){return s.from((this.x<<0)-(this.x<0&&this.x!==this.x<<0?1:0),(this.y<<0)-(this.y<0&&this.y!==this.y<<0?1:0),(this.z<<0)-(this.z<0&&this.z!==this.z<<0?1:0))}almostEqual(t,e,i,r){try{let o;return typeof t!="number"&&i===void 0?(o=s._from(t,void 0,void 0),r=e):o=s._from(t,e,i),Math.abs(this.x-o.x)<=r&&Math.abs(this.y-o.y)<=r&&Math.abs(this.z-o.z)<=r}catch{return!1}}equals(t,e,i){try{let r=s._from(t,e,i);return this.x===r.x&&this.y===r.y&&this.z===r.z}catch{return!1}}toString(t="long",e=", "){let i=`${this.x+e+this.y+e+this.z}`;return t==="long"?`Vec3(${i})`:i}static fromString(t,e="long",i=", "){if(e==="long"){let r=t.match(/^Vec3\((.*)\)$/);if(!r)throw new Error("Invalid string format");let o=r[1].split(i);if(o.length!==3)throw new Error("Invalid string format");return s.from(Number(o[0]),Number(o[1]),Number(o[2]))}else{let r=t.split(i);if(r.length!==3)throw new Error("Invalid string format");return s.from(Number(r[0]),Number(r[1]),Number(r[2]))}}},x=class N{static log=A.getLogger("Timings","timings");static lastTime=-1;static lastOperation="";static begin(t){this.end(),this.lastTime=new Date().getTime(),this.lastOperation=t}static end(){let t=new Date().getTime();this.lastTime>0&&N.log.debug(`Operation ${this.lastOperation} took ${t-this.lastTime}ms`),this.lastTime=-1}};function E(d){let t=Object.getPrototypeOf(d).isValid;return typeof t=="function"?t.call(d):d.isValid}var st=A.getLogger("jobUtils","bedrock-boost","jobUtils");var U=class M{static log=A.getLogger("PulseScheduler","bedrock-boost","pulse-scheduler");items=[];period;currentTick=0;runId;nextIndex=0;executionSchedule=[];processor;constructor(t,e){if(e<=0)throw new Error("Period must be a positive integer.");if(!t||typeof t!="function")throw new Error("Processor function must be defined.");this.period=e,this.processor=t}add(t){this.push(t)}addAll(t){this.push(...t)}remove(t){t>=0&&t<this.items.length&&(this.items.splice(t,1),t<this.nextIndex&&this.nextIndex--,this.recalculateExecutionSchedule())}removeIf(t){for(let e=this.items.length-1;e>=0;e--)t(this.items[e])&&this.remove(e)}getItems(){return this.items}start(){this.stop(),this.currentTick=0,this.nextIndex=0,this.runId=k.runInterval(()=>this.tick(),1)}stop(){this.runId!==void 0&&(k.clearRun(this.runId),this.runId=void 0)}recalculateExecutionSchedule(){let t=this.items.length;if(this.executionSchedule=new Array(this.period).fill(0),t===0)return;let e=this.period/t;for(let i=0;i<t;i++)this.executionSchedule[Math.round(e*i)%this.period]++}tick(){if(this.items.length===0){M.log.trace("No items to process.");return}let t=this.executionSchedule[this.currentTick];if(t===0){M.log.trace("No items to process this tick."),this.currentTick=(this.currentTick+1)%this.period,this.currentTick===0&&(this.nextIndex=0);return}let e=0;for(;this.nextIndex<this.items.length&&e<t;this.nextIndex++){try{this.processor(this.items[this.nextIndex])}catch(i){M.log.error("Error processing item",i)}e++}this.currentTick=(this.currentTick+1)%this.period,this.currentTick===0&&(this.nextIndex=0)}push(...t){return this.items.push(...t),this.recalculateExecutionSchedule(),this.items.length}pop(){let t=this.items.pop();return this.recalculateExecutionSchedule(),t}shift(){let t=this.items.shift();return this.recalculateExecutionSchedule(),t}unshift(...t){return this.items.unshift(...t),this.recalculateExecutionSchedule(),this.items.length}splice(t,e=0,...i){let r=this.items.splice(t,e,...i);return this.recalculateExecutionSchedule(),r}};var at=class $ extends U{constructor(t,e,i){super(r=>{E(r)?t(r):this.removeIf(o=>!E(o))},e),this.queryOptions=i,this.push(...C.getDimension("minecraft:overworld").getEntities(this.queryOptions)),this.push(...C.getDimension("minecraft:nether").getEntities(this.queryOptions)),this.push(...C.getDimension("minecraft:the_end").getEntities(this.queryOptions))}static logger=A.getLogger("EntityPulseScheduler","bedrock-boost","entity-pulse-scheduler");compareEntities(t,e){return t.id===e.id}start(){C.afterEvents.entityLoad.subscribe(t=>{this.addIfMatchesWithRetry(t.entity)}),C.afterEvents.entitySpawn.subscribe(t=>{this.addIfMatchesWithRetry(t.entity)}),C.afterEvents.entityRemove.subscribe(t=>{this.removeIf(e=>!E(e)||e.id===t.removedEntityId)}),super.start()}addIfMatchesWithRetry(t){try{if(!t)return;E(t)?t.matches(this.queryOptions)&&this.push(t):F.runInterval(()=>{E(t)&&t.matches(this.queryOptions)&&this.push(t)},1)}catch(e){$.logger.debug("Failed to push entity to scheduler.",e)}}push(...t){let e=t.filter(i=>E(i)&&!this.items.some(r=>this.compareEntities(r,i)));return super.push(...e)}unshift(...t){let e=t.filter(i=>E(i)&&!this.items.some(r=>this.compareEntities(r,i)));return super.unshift(...e)}splice(t,e,...i){if(e===void 0)return super.splice(t);let r=i.filter(o=>!this.items.some(c=>this.compareEntities(c,o)));return super.splice(t,e,...r)}},lt=class L extends U{static logger=A.getLogger("PlayerPulseScheduler","bedrock-boost","player-pulse-scheduler");constructor(t,e){super(i=>{E(i)?t(i):this.removeIf(r=>!E(r))},e),this.push(...R.getAllPlayers())}compareEntities(t,e){return t.id===e.id}start(){R.afterEvents.playerJoin.subscribe(t=>{let e=0,i=()=>{if(e++,e>10){L.logger.debug("Failed to push player to scheduler after 10 attempts.");return}try{let r=R.getEntity(t.playerId);r===void 0&&P.runTimeout(i,1),r instanceof W&&this.push(r)}catch(r){L.logger.debug("Failed to push player to scheduler.",r),P.runTimeout(i,1)}};i()}),R.afterEvents.playerLeave.subscribe(t=>{this.removeIf(e=>!E(e)||e.id===t.playerId)}),super.start()}push(...t){let e=t.filter(i=>E(i)&&!this.items.some(r=>this.compareEntities(r,i)));return super.push(...e)}unshift(...t){let e=t.filter(i=>E(i)&&!this.items.some(r=>this.compareEntities(r,i)));return super.unshift(...e)}splice(t,e,...i){if(e===void 0)return super.splice(t);let r=i.filter(o=>!this.items.some(c=>this.compareEntities(c,o)));return super.splice(t,e,...r)}};var gt=class{static Opposites={[l.Down]:l.Up,[l.Up]:l.Down,[l.North]:l.South,[l.South]:l.North,[l.East]:l.West,[l.West]:l.East};static PositivePerpendiculars={[l.Down]:[l.East,l.North],[l.Up]:[l.East,l.North],[l.North]:[l.East,l.Up],[l.South]:[l.East,l.Up],[l.East]:[l.North,l.Up],[l.West]:[l.North,l.Up]};static NegativePerpendiculars={[l.Down]:[l.West,l.South],[l.Up]:[l.West,l.South],[l.North]:[l.West,l.Down],[l.South]:[l.West,l.Down],[l.East]:[l.South,l.Down],[l.West]:[l.South,l.Down]};static Values=[l.Down,l.Up,l.North,l.South,l.East,l.West]};var vt=A.getLogger("itemUtils","bedrock-boost","itemUtils");var q=A.getLogger("Dinoscript");B.afterEvents.playerPlaceBlock.subscribe(d=>{q.info("Placed",d.block.typeId)});
//# sourceMappingURL=main.js.map
